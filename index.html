<html>
	<head>
		<title>Sound of Cyber</title>
		<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
	</head>
	<body>

		<div class="mypanel"></div>
		<script>
			$.getJSON('/get_sound_data', function(data) {
				
				var text = data
				console.log(data)
				// Einzelne Daten
				function play_sound(data, index)
					{
						bip(data[index].freq, data[index].length)
						index++
						if(index < data.length){
						window.setTimeout(play_sound, data[index].length*1000, data, index)
						}
					}


					function bip(f, t){
					console.log("Beeping")
					var context = new AudioContext()
					var o = context.createOscillator()
					var g = context.createGain()
					o.connect(g)
					g.connect(context.destination)
					o.frequency.value = f
					o.start(0)				
					g.gain.exponentialRampToValueAtTime(0.000001, t*0.99)
					o.stop(t)
					}
					function biprepeat(f, t, r, i){
						while(r>0){
							window.setTimeout(bip, r*i*1000, f, t)
							r-=1
						}				
						}
				play_sound(data, 0)
							
				
				$(".mypanel").html(text);
			});
		</script>
		
	</body>
</html>
